<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://unpkg.com/redux@latest/dist/redux.min.js"></script>
    <script src="https://unpkg.com/redux-logger@3.0.6/dist/redux-logger.js"></script>
    <script src="//cdn.jsdelivr.net/npm/pouchdb@7.0.0/dist/pouchdb.min.js"></script>
    <script src="./pouchdb.authentication.js"></script>
</head>
<body>
    <script>
        let user = "four"
        function loadjs(file) {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = file;
            script.onload = function(){

            };
            document.body.appendChild(script);
        }

        const db = new PouchDB('mydb');

        var couchDB = new PouchDB(`http://plex:1111111111@10.0.1.7:5984/redux${user}`);

        db
        .replicate
        .from(couchDB)
        .on('complete', (info) => {
            console.log('info');
            console.log(info);
            loadjs('./build/bundle.js')
            let myApp = document.createElement('my-app');
            document.body.appendChild(myApp);
            db.sync(couchDB, { live: true, retry: true })
        })
        .on('error', (info) => {
            console.log('error');
            console.log(info);
        })
        .on('change', (info) => {
            console.log('change');
            console.log(info);
        });


        // couchDB.logIn('plex', '1111111111')
        // .then(function (response) {
        //     console.log("I'm Batman.");
        //     console.log(response);
        //     couchDB
        //     .info()
        //     .then(info => {
        //         console.log('info');
        //         console.log(info);
        //         db
        //         .replicate
        //         .from(remotedb)
        //         .on('complete', (info) => {
        //             console.log('info');
        //             console.log(info);
        //             loadjs('./build/bundle.js')
        //             let myApp = document.createElement('my-app');
        //             document.body.appendChild(myApp);
        //             db.sync(`http://10.0.1.7:5984/redux${user}`, { live: true, retry: true })
        //         })
        //         .on('error', (info) => {
        //             console.log('error');
        //             console.log(info);
        //         })
        //         .on('change', (info) => {
        //             console.log('change');
        //             console.log(info);
        //         });
        //     });
            



        //return db.logOut();
        // });


    </script>
</body>
</html>